---
title: "Pseudo_Facebook_data"
output: html_document
---
```{r}
#install.packages('ggplot2')
library(ggplot2)
#install.packages('gridExtra')
library(gridExtra)
#install.packages('dplyr')
library(dplyr)
#install.packages('reshape2')
library(reshape2)
```

Read in the psuedo Facebook data.
```{r}
#use sep to indicate file is tab seperated
pf <- read.csv('pseudo_facebook.tsv', sep = '\t')
names(pf)
```

## Friend count
Let's see look in to the friend count and see if there's much of a difference in friend count between male and female users. We would like to omit the rows which have 'NA' as their gender by subseting the data to only include the rows that don't have NA as gender.
```{r Omitting NA Values}
qplot(x = friend_count, data = subset(pf, !is.na(gender)), binwidth = 10) +
  scale_x_continuous(limits = c(0, 1000),
                     breaks = seq(0, 1000, 50)) +
  facet_wrap(~gender)
```
From this plot it looks like male users have a higher proportion of low friend count 
than female useers. Let's look at the statistics of friend count by gender to 
get a clearer idea of the difference in friend count.
```{r Statistics \'by\' Gender}
table(pf$gender)
by(pf$friend_count, pf$gender, summary)
```
Both the median and mean friend count for female users is higher than for males. 
The median friend count will be a more robust statistic in this case as extreme 
outliers may skew the mean friend count. 

Visulaising this with box plots. Adjust the code to focus on users who have 
friend counts between 0 and 1000.
```{r}
ggplot(aes(x = gender, y=friend_count), 
       data = subset(pf, !is.na(gender))) +
  geom_boxplot() +
  coord_cartesian(ylim=c(0,1000))
```

### Proportion of friend count
Comparing male and female friend counts in an overlay with a *frequency polygon* 
rather than two histograms side by side. 
Change the y axis to show prportions instead of counts.

```{r Frequency Polygons}
ggplot(aes(x = friend_count, y = ..count../sum(..count..)),
       data = subset(pf, !is.na(gender))) +
  geom_freqpoly(aes(color = gender), binwidth=10) +
  scale_x_continuous(limits = c(0, 1000), breaks = seq(0, 1000, 50)) +
  xlab('Friend Count') +
  ylab('Proportion of users with that friend count')
```
A higher proportion of male users have a low friend count than women do. Towards 
the higher end of friend count (300+) male and female users seem to be close.

Let's look in to some of the factors that might affect friend count.

### (i) Tenure
Friend count will be affected by how long a user has been a member of Facebook so let's plot the tenure for Facebook users.
```{r Tenure Histogram by Year}
qplot(x=tenure/365, data = pf, binwidth=0.25, 
      xlab ='Number of years using Facebook',
      ylab='Number of users in sample',
      color=I('black'), fill=I('#F79420') )
```
The majority of users have been on Facebook for less than 2.5 years. However, 
those that have been on Facebook longer will likely have gained more friends over
time than the newer users. 

## (ii) User Ages
Let's see what age groups use Facebook. 
```{r User Ages}
summary(pf$age) #give the min and max ages help determine scale for x axis
qplot(x=age, data=pf, binwidth=1, xlab = "age", 
      ylab='Number of users in sample',
      color=I('black'), fill=I('#5760AB')) +
      scale_x_continuous(breaks = seq(13,113,5)) #seq(0,113,5) goes from 0 to 113 in units of 5 on x axis
```
The summary shows the minimum age is 13 and the max is 113. This is useful as you 
can't use facebook if you're younger than 13 and we're not confident about the 
data we have for the over 90s are truthful. 

Now let's see if friend count varies by the age of users on Facebook.
```{r Scatterplots}
ggplot(aes(x=age, y=friend_count), data =pf) + geom_jitter(alpha=1/20) + 
  xlim(13, 90)

summary(pf$age)
```
* There are vertical bars where people have lied about their age - e.g. 69 and 
100. These users are likely to be teenagers or fake accounts given the huge 
friend counts.
* The users with the most friends are typically under 30.
* The bulk of young users have friend count below 1000.

Transform the plot using square root:
```{r Coord_trans()}
ggplot(aes(x=age, y=friend_count), data =pf) + 
  geom_point(alpha=1/20, position = position_jitter(h=0)) + 
  xlim(13, 90) +
  coord_trans(y = 'sqrt') #transform y axis to square root values
```
With this plot it's much easier to see the distribution of friend count 
conditional on age. For example we can see threshold count above which there are 
very few users.























